# 任务三、实现登录和注册功能

## 任务描述

​	本任务旨在为“AI Will综合素养挑战赛”官方网站实现用户登录和注册功能，以便参赛者和用户能够安全、便捷地访问和参与比赛。任务包括配置axios进行网络请求、使用Pinia进行状态管理、构建注册和登录表单页面、实现忘记密码功能、管理前端路由以及与后端API接口对接。此外，还需确保表单验证的准确性和数据的持久化，以提供流畅的用户体验并保障账户安全。

## 任务效果

### 注册模块

![image-20240306083742687](images/image-20240306083742687.png)

### 登录模块

​	用户在成功登录后，初始状态将设定为“待审核”。在此状态下，用户可以查看个人信息，但无法进行编辑或执行其他操作。审核权限由上级管理机构（组委会）负责，用户需等待组委会完成审核并批准后，方可对页面内容进行编辑和其他相关操作。

![image-20240306083500380](images/image-20240306083500380.png)

### 忘记密码模块

![image-20240311111131278](images/image-20240311111131278.png)

## 学习目标

### 知识目标

- [ ] 理解axios库的基本概念和用法
- [ ] 理解如何处理axios请求的响应和错误
- [ ] 理解如何使用Element UI或其他UI框架提供的表单验证功能。
- [ ] 理解Pinia的基本概念，它是Vue的状态管理库，类似于Vuex
- [ ] 掌握使用Vue Router进行前端路由管理的基本概念

### 能力目标

- [ ] 能够使用axios库完成与后端API的数据交互。
- [ ] 能够实现登录、注册功能的API请求，并在前端页面上展示交互结果。
- [ ] 能够实现用户输入的格式验证，确保手机号码、密码等关键字段的正确性。
- [ ] 能够应用Pinia状态管理库维护应用状态，保障数据流的一致性和应用的可维护性。

## 知识储备

### 1.pinia介绍

​	Pinia 是 Vue 新一代的轻量级状态管理库，相当于Vuex，也是Vue核心团队推荐的状态管理库。并且实现了一些Vuex 5的RFCs，同时支持 Vue2 和 Vue3。未来很有可能替代Vuex，比Vuex更容易上手。

#### 1、vuex和pinia的区别

> 1、pinia没有mutations，只有: state、getters、actions（vuex有mutations）
>
> 2、pinia分模块不需要modules（vuex分模块需要modules）
>
> 3、pinia体积更小（性能更好）
>
> 4、pinia可以直接修改state数据（vuex还需要通过mutations来进行修改）

### 2.基本使用

#### 2.1 安装

下述demo使用vue3， 先用vite快速创建一个vue项目：

> npm init vite@latest

安装pinia

> npm install pinia

在 src/main.ts 文件，使用Vue.use()方法将pinia作为插件使用：

```js
import { createApp } from 'vue'
import { createPinia } from 'pinia'
import App from './App.vue'
createApp(App).use(createPinia()).mount('#app')
```

#### 2.2 Pinia 模块的创建

​	可以在vue的项目中，在src文件夹下面创建一个store文件夹专门来管理我们的pinia 模块。在文件夹下面我们可以创建多个js文件来对应我们的模块。

下面就是store 文件夹下面创建的一个index.js模块。

```js
// 想要使用必须先引入 defineStore；
import { defineStore } from 'pinia';
// 这里我们使用的是es6 的模块化规范进行导出的。

// defineStore 方法有两个参数，第一个参数是模块化名字（也就相当于身份证一样，不能重复）

// 第二个参数是选项，对象里面有三个属性，相比于vuex 少了一个 mutations.
export const useStore = defineStore('main', {
  state(){  // 存放的就是模块的变量
    return {
      count: 10
    }
  },
  getters:{ // 相当于vue里面的计算属性，可以缓存数据

  },
  actions:{ // 可以通过actions 方法，改变 state 里面的值。
      
  }
})
```

##### 2.2 Pinia 数据页面的使用

​	我们以vue3 页面为例，简单介绍一下，Pinia页面的使用。

```js
<template>
  <div>
    <p>{{store.count}}</p>
  </div>
</template>
<script>
// 这里引入我们导出的 useStore；
import { useStore } from '../store/index.js'
export default {
  setup(props) {
   // 值得注意的是 useStore 是一个方法，调用之后会给我们返回一个对象。
  //  这个时候，你就会发现，页面上就能正常显示我们在index.js 里面的 state 里面定义的 count 数据。
    const store = useStore();
    return {
      store
    }
  }
}
</script>
```

#### 2.3 pinia 中 修改 state 数据的方法。

##### 3.1直接修改 store 对象的数据

```js
// html 代码
<p>{{count}}</p>
<button @click="add">累计</button>
// js 代码
const store = useStore();
const add = () => {
       store.count ++ 
 }
```

##### 3.2 $patch 方法传递一个对象来修改。

```js
// html 代码
<p>{{count}}</p>
<button @click="add">累计</button>
// js 代码
const store = useStore();
 const add = () => {
      store.$patch({
        count: store.count + 1
      })
    }
```

##### 3.3 actions 里面修改数据

```js
// 首先我们需要在 actions 里面定义一个方法
import { defineStore } from 'pinia';
export const useStore = defineStore('main', {
  state(){
    return {
      count: 10,
      num: 20
    }
  },
  getters:{

  },
  
  actions:{
    piniaAdd(){ 
       this.count++;
       // 特别注意：在这里this指向的就是当前的实例化出来的对象，piniaAdd 该函数如果换成箭头函数的话，this 指向就会发生 改变，不能再使用 this.count++; 了
    }
  }
})

// 页面
// html 代码
 <p>我是count数据{{count}}</p>
 <p>num{{num}}</p>
 <button @click="add">累计</button>
// js代码
 const store = useStore();
const add = () => {
      store.piniaAdd();
}
```

### 3.pinia 固化插件的使用

```csharp
npm i pinia-plugin-persist --save --include=dev
// 或者使用 yarn 安装
yarn add pinia-plugin-persist
```

安装完成之后，我们可以在main.js 或者 main.ts 中引入。具体代码如下：

```js
import { createApp } from 'vue'

import App from './App.vue'

import { createPinia } from 'pinia';
// 下面是我们安装的固化插件。
import piniaPersist from 'pinia-plugin-persist'

const app = createApp(App);

const pinia = createPinia();

pinia.use(piniaPersist);

// 特别注意：固化插件是 pinia.use 并不是 app.use

app.use(pinia);

app.mount('#app')
```

具体模块中的使用看下面的代码：

```js
import { defineStore } from 'pinia';
export const useStore = defineStore('main', {
  state(){
    return {
      count: 10,
      num: 20
    }
  },
  persist: { //  固化插件
    enabled: true, // 开启存储
     strategies: [ // 指定存储的位置以及存储的变量都有哪些，该属性可以不写，
        //在不写的情况下，默认存储到 sessionStorage 里面,默认存储 state 里面的所有数据。
      { storage: localStorage, paths: ["count"] },
      // paths 是一个数组，如果写了 就会只存储 count 变量，当然也可以写多个。
    ]
  },
  getters:{

  },
  
  actions:{
    piniaAdd(){
       this.count++;
    }
  }
})
```

## 任务实施

### 子任务3-1 实现注册模块

​	在“AI Will综合素养挑战赛”的官方网站中，登录模块是用户参与比赛和享受平台服务的关键入口。该模块的设计旨在为用户提供一个安全、便捷且直观的登录体验，确保他们能够轻松地进入比赛的世界。

#### 步骤一 配置axios

##### 1.axios介绍

​	axios是一种流行的JavaScript库，用于进行HTTP请求。它是基于Promise的，并提供了一种简洁而强大的方式来与后端API进行通信。axios可以在浏览器和Node.js环境中使用

##### 2.封装axios

> 文件路径：/src/utils/axios.js

代码如下：

```js
import axios from 'axios';

// 设置API的基础URL，根据环境变量进行配置
// 在生产环境中，baseURL可能会根据环境变量VITE_API_HOST进行调整
const baseURL = '/api'; // 这里假设所有环境都使用相同的API路径

// 创建axios实例，并设置超时时间为30秒
const r = axios.create({
    baseURL: baseURL,
    timeout: 30000
});

// 请求拦截器
// 在发送请求之前，检查本地存储中是否有token
// 如果有token，将其添加到请求头中作为授权凭证
r.interceptors.request.use(function (config) {
    let token = localStorage.getItem("token");
    if (token) {
        if (!config.headers) {
            // 如果请求头不存在，则创建一个新的headers对象
            config.headers = {};
        }
        // 设置Authorization请求头，携带token
        config.headers.Authorization = token;
    }
    return config;
}, function (error) {
    // 对请求错误进行处理，例如网络问题或配置错误
    // 返回reject的Promise，表示请求失败
    return Promise.reject(error);
});

// 响应拦截器
// 对响应数据进行处理，例如检查状态码或处理错误
r.interceptors.response.use(function (response) {
    // 对于2xx状态码的响应，执行这里的代码
    // 通常，我们直接返回响应的数据部分
    return response.data;
}, function (error) {
    // 对于非2xx状态码的响应，执行这里的代码
    // 这里可以处理错误，例如网络错误、服务器错误等
    // 返回reject的Promise，表示响应失败
    return Promise.reject(error);
});

// 导出一个请求函数，用于发起API请求
// 这个函数接收一个配置对象，该对象定义了请求的URL、方法、数据等
export function request(config) {
    // 使用创建的axios实例发起请求，并返回Promise
    return r.request(config);
}
```

#####  3.使用axios

> 文件路径：/src/api/user.js

代码如下:

```js
import { request } from "@/utils/axios"; // 引入自定义的axios请求封装函数

/**
 * 登录接口
 * 该函数用于处理用户登录的API请求。
 * @param {Object} data - 包含登录所需的用户信息，如用户名和密码。
 * @returns {Promise} - 返回一个Promise对象，用于异步处理登录请求的结果。
 */
export function LoginApi(data) {
    // 使用封装的axios请求函数发起POST请求到用户登录的API端点
    return request({
        url: "/user/login", // 设置请求的URL为用户登录的API路径
        method: "POST", // 设置请求方法为POST
        data: data // 将用户信息作为请求体发送
    });
}
```

#### 步骤二 模块依赖安装

##### 1.pinia介绍

​	Pinia 是一个轻量级的 Vue.js 状态管理库，它旨在提供一个简单、直观且功能强大的解决方案来管理应用程序的状态。Pinia 的设计灵感来源于 Vuex，但它更注重易用性和开发体验，同时减少了样板代码。

##### 2.安装pinia

- pinia

  安装指令:` npm i pinia -S `

##### 3.查看安装依赖

> 文件路径：/package.json

如下图：

![image-20240306170850089](images/image-20240306170850089.png)

`dependencies` 是用于生产环境的依赖项，它们是我们在部署应用程序时所必需的。就像我们在烹饪中需要的原料一样，这些依赖项提供了我们应用程序运行所需的核心功能。

`devDependencies` 是用于开发环境的依赖项，它们主要用于辅助我们进行开发、测试和构建应用程序。它们就像是我们在烹饪过程中使用的工具和设备。

##### 4.pinia的使用

**创建pinia文件**

1. 在VSCode中打开您的Vue项目。
2. 在侧边栏的文件资源管理器中，右键单击 `src` 文件夹。
3. 选择 "New Folder" （新建文件夹），然后命名为 `store`。
4. 在 `store` 文件夹上右键单击，选择 "New File" （新建文件），然后命名为 `index.js`。
5. 在 `main.js` 文件中引入当前创建的代码：

> 文件路径：/src/main.js

代码如下：

```js
import { createApp } from 'vue'
import '@/assets/style/style.css' // 导入全局样式文件
import App from './App.vue' // 导入根组件
// 路由
import router from "@/router" // 导入路由配置

// 状态管理
import store from "@/store"
// 组件库
import ElementPlus from 'element-plus' // 导入 Element Plus 组件库
import 'element-plus/dist/index.css' // 导入 Element Plus 的 CSS 样式文件

// 创建 Vue 应用实例
const app = createApp(App)
app.use(router); // 使用路由
app.use(ElementPlus); // 使用 Element Plus 组件库
app.use(store);

app.mount('#app') // 将应用挂载到 HTML 页面上的 #app 元素
```

> 文件路径：/src/store/index.js

代码如下:

```js
import { createPinia } from 'pinia'
export default createPinia();
```

#### 步骤三 编写路由配置

​	在这段对话中，给用户提供了一个关于注册模块路由配置的代码片段。代码中使用了Vue Router库来创建路由实例，并定义了多个路由路径和对应的组件。通过这段代码的配置，当用户访问不同的路径时，Vue Router会加载对应的组件并在页面中展示出来。

> 文件路径：/src/router/index.js

代码如下：

```js
import { createRouter, createWebHashHistory, createWebHistory } from "vue-router";
// routes
const routes = [
    {
        redirect: "/home",
        path: "/"
    },
    // 首页
    {
        path: '/home',
        name: "home",
        component: () => import("@/view/home/index.vue")
    },
    // 管理页
    {
        path: '/manage',
        name: "manage",
        component: () => import("@/view/manage/index.vue"),
    },
    // auth
    {
        path: '/auth',
        redirect: "/auth/login",
        component: () => import("@/view/auth/index.vue"),
        children: [
            // 注册
            {
                path: 'reg',
                component: () => import("@/view/auth/reg.vue")
            },
        ]
    },
]

// router
const router = createRouter({
    history: createWebHashHistory(),
    routes
});

export default router;
```

#### 步骤四 编写接口

##### 1.查看接口

![image-20240315164718445](images/image-20240315164718445.png)

##### 2.编写接口

> 文件路径：/src/api/user.js

注册:`/user/register`

```js
import { request } from "@/utils/axios"; // 引入自定义的axios请求封装函数

/**
 * 注册
 */
export function RegApi(data) {
    return request(
        {
            url: "/user/register",
            method: "POST",
            data: data
        }
    );
}
```

> 文件路径：/src/api/common.js

获取地区:`/information/getArea`

```js
import { request } from "@/utils/axios"


/**
 * 获取地区 
 */
export function getAreaApi(pid = 1) {
    return request(
        {
            url: "/information/getArea",
            method: "GET",
            params: {
                pid: pid ?? undefined
            }
        }
    );
}
        
 /**
 * 图片验证码
 */
export function GetCodeApi(params) {
    return request(
        {
            url: '/information/getCode',
            method: "GET",
            params
        }
    );
}
```

> 文件路径：/src/api/index.js

获取验证码:`/information/sendCode`

```js
import { request } from "@/utils/axios"

/**
 * 获取验证码
 */
export function sendCode(params) {
    return request(
        {
            url: "/information/sendCode",
            method: "GET",
            params: params,
        }
    );
}
```

#### 步骤五 实现组件编写

##### 1.验证图片自定义钩子

​	配置这个验证图片自定义钩子`useValidateImage`的目的是为了提供一个便捷的方法来管理和更新验证图片的URL。这个自定义钩子通过调用后端API获取新的验证图片，并将其以Base64编码的形式嵌入到页面中，以确保验证图片能够及时更新并显示给用户。

> 文件路径：/src/hooks/useValidateImage.js

代码如下：

```js
import { ref } from "vue"
import { GetCodeApi } from "@/api/common"

/**
 * 使用验证图片逻辑的自定义 Hook
 * 该 Hook 用于获取验证图片并更新验证图片 URL
 * @returns {Object} 包含验证图片 URL 和更新验证图片方法的对象
 */
export function useValidateImage() {
    // 创建 ref 来存储验证图片的 URL
    const validate_image_url = ref("")

    // 定义更新验证图片的方法
    const update_validate_image = async () => {
        // 生成随机数作为请求参数
        const t = Math.random() * 9999

        // 调用获取验证码 API
        let res = await GetCodeApi({ t: t })

        // 如果获取验证码成功，则更新验证图片 URL
        if (res.success) {
            validate_image_url.value = "data:image/jpeg;base64," + res.entity;
        }
    }

    // 初始化时调用更新验证图片的方法
    update_validate_image();

    // 返回包含验证图片 URL 和更新验证图片方法的对象
    return {
        validate_image_url,
        update_validate_image
    };
}
```

##### 2.编写省份选择组件

​	编写省份选择组件的目的是为了提供一个灵活、高效的用户界面组件，使用户能够选择和输入他们的地理位置信息，包括省、市和区/县。这个组件利用Vue的响应式系统和计算属性，结合Element Plus UI库的下拉选择框，实现了级联选择的功能。通过缓存和异步加载地区数据，组件不仅优化了性能，还提高了用户体验

复制再试一次分享

> 文件路径：/src/components/province-select/index.vue

代码如下：

```vue
<template>
  <!-- 使用 Element Plus 的空间分隔组件（el-space）来排列选择框 -->
  <el-space style="width: 100%">
    <!-- 第一级下拉选择框：所在省 -->
    <el-select
      :class="{ 'w-input': isW }"
      clearable
      v-model="area_data.value[0]"
      placeholder="所在省"
      size="large"
      @change="
        (value) => {
          handleValueChange(value, 0);
        }
      "
      @clear="
        (value) => {
          handleValueClear(value, 0);
        }
      "
      :disabled="disabled"
    >
      <!-- 循环渲染第一级选项 -->
      <el-option
        v-for="item in list_1"
        :key="item.districtId"
        :label="item.district"
        :value="item.districtId"
      />
    </el-select>
    <!-- 第二级下拉选择框：所在市 -->
    <el-select
      :class="{ 'w-input': isW }"
      clearable
      v-model="area_data.value[1]"
      placeholder="所在市"
      size="large"
      v-if="props.showMarket"
      :disabled="!area_data.value[0] || disabled"
      @change="
        (value) => {
          handleValueChange(value, 1);
        }
      "
      @clear="
        (value) => {
          handleValueClear(value, 0);
        } // 清空时的事件处理
      "
    >
      <!-- 循环渲染第二级选项 -->
      <el-option
        v-for="item in area_data.data[1]"
        :key="item.districtId"
        :label="item.district"
        :value="item.districtId"
      />
    </el-select>
    <!-- 第三级下拉选择框：所在区/县 -->
    <el-select
      :class="{ 'w-input': isW }"
      clearable
      v-model="area_data.value[2]"
      placeholder="所在区/县"
      size="large"
      :disabled="!area_data.value[1] || disabled"
      @change="
        (value) => {
          handleValueChange(value, 2);
        }
      "
      @clear="
        (value) => {
          handleValueClear(value, 0);
        }
      "
      v-if="props.showCounty"
    >
      <!-- 循环渲染第三级选项 -->
      <el-option
        v-for="item in area_data.data[2]"
        :key="item.districtId"
        :label="item.district"
        :value="item.districtId"
      /> </el-select
  ></el-space>
</template>

<script setup>
import { computed, onMounted, ref, watch } from "vue";
import { getAreaApi } from "@/api/common"; //导入获取地区数据的API
//定义组件接收的props
const props = defineProps({
  economize: {
    default: "",
    type: String,
  },
  market: "",
  county: "",
  showMarket: {
    default: true,
    type: Boolean,
  },
  showCounty: {
    default: false,
    type: Boolean,
  },
  disabled: {
    default: false,
    type: Boolean,
  },
  isW: {
    default: false,
    type: Boolean,
  },
  addChina: {
    default: false,
    type: Boolean,
  },
});
const emit = defineEmits([
  "update:economize",
  "update:market",
  "update:county",
]);
const area_data = ref({
  value: ["", "", ""],
  data: [[], [], []],
  map: {},
});
/**
 * 获取lv1
 */
const handleGetArea = async (pid, index = 0) => {
  let entityList = [];
  const area_data_map = localStorage.getItem("area_data_map") ?? null;

  if (area_data.value.map[pid]) {
    entityList = area_data.value.map[pid];
  } else {
    let bool = false;
    if (area_data_map) {
      try {
        if (JSON.parse(area_data_map)[pid]) {
          entityList = JSON.parse(area_data_map)[pid];
          bool = true;
        }
      } catch (error) {
        bool = false;
      }
    }
    if (!bool) {
      let res = await getAreaApi(pid);
      if (res.success) {
        entityList = res.entityList;
      }
    }
  }
  area_data.value.data[index] = entityList;
  area_data.value.map[pid] = entityList;
  localStorage.setItem("area_data_map", JSON.stringify(area_data.value.map));
};

//初始化地区数据的函数
const handleInit = async () => {
  await handleGetArea(1, 0);
  if (props.economize && props.market && props.county) {
    await handleGetArea(props.economize, 1);
    await handleGetArea(props.market, 2);
    const economize = area_data.value.data[0].find(
      (item) => item.districtId == String(props.economize)
    )
      ? props.economize
      : "";
    const market = area_data.value.data[1].find(
      (item) => item.districtId == String(props.market)
    )
      ? props.market
      : "";
    const county = area_data.value.data[2].find(
      (item) => item.districtId == String(props.county)
    )
      ? props.county
      : "";
    area_data.value.value = [economize, market, county];
  } else if (props.economize && props.market) {
    await handleGetArea(props.economize, 1);
    area_data.value.value = [props.economize, props.market, ""];
  } else if (props.economize) {
    await handleGetArea(props.economize, 1);
    area_data.value.value = [props.economize, "", ""];
  } else if (!props.economize && !props.market && !props.county) {
    area_data.value.value = ["", "", ""];
  }
};
// 监听props变化，重新初始化地区数据
watch(
  () => props.economize,
  () => {
    handleInit();
  }
);
watch(
  () => props.market,
  () => {
    handleInit();
  }
);
watch(
  () => props.county,
  () => {
    handleInit();
  }
);

// 处理值变化的函数
const handleValueChange = (value, index) => {
  if (index == 0) {
    area_data.value.value[1] = "";
    area_data.value.value[2] = "";
    handleGetArea(value, 1);
  } else if (index == 1) {
    area_data.value.value[2] = "";
    handleGetArea(value, 2);
    if (!props.showCounty) {
      //   handleChange("economize", 0);
      //   handleChange("market", 1);
    }
  } else if (index == 2) {
    // handleChange("economize", 0);
    // handleChange("market", 1);
    // handleChange("county", 2);
  }
  handleChange("economize", 0);
  handleChange("market", 1);
  handleChange("county", 2);
};

// 处理值清空的函数
const handleValueClear = (value, index) => {
  if (index == 0) {
    area_data.value.value[0] = "";
    area_data.value.value[1] = "";
    area_data.value.value[2] = "";
    handleChange("economize", 0);
    handleChange("market", 1);
    handleChange("county", 2);
  } else if (index == 1) {
    area_data.value.value[1] = "";
    area_data.value.value[2] = "";
    handleChange("market", 1);
    handleChange("county", 2);
  } else if (index == 2) {
    area_data.value.value[2] = "";
    handleChange("county", 2);
  }
};

//处理值变化并触发emit的函数
const handleChange = (key = "economize", index = 0) => {
  let values = area_data.value.value;
  emit("update:" + key, values[index]);
};

// 计算属性，用于获取第一级选项列表
const list_1 = computed(() => {
  let arr = [];
  if (props.addChina) {
    arr.push({
      districtId: 1,
      district: "中国",
    });
  }
  arr.push(...area_data.value.data[0]);
  return arr;
});

// 组件挂载后执行的函数
onMounted(() => {
  handleInit();
});
</script>

<style lang="scss" scoped>
.w-input {
  width: 120px;

  :deep(.el-input) {
    width: 120px;
  }

  .el-input-number {
    width: 120px;
  }
}
</style>
```

效果图预览

![image-20240308175111981](images/image-20240308175111981.png)

##### 3.手机验证码组件

​	配置手机验证码组件的目的是为了实现一个手机验证码组件，用于在表单中验证用户输入的手机号码，并发送验证码进行进一步的身份验证。这个组件配置了手机号码输入框、获取验证码按钮、验证码输入对话框以及发送验证码的功能。

> 文件路径：/src/components/phone-send-code/index.vue

代码如下：

```vue
<template>
  <!-- 表单容器 -->
  <div class="form-container">
    <el-input
      v-model="props.modelValue"
      @input="handleInput"
      placeholder="请输入手机号码"
    />
    <!-- 获取验证码按钮，根据条件禁用 -->
    <el-button
      plain
      class="ipn_btn"
      @click="handleOpenModal()"
      :disabled="disabled"
      >{{ btnText }}
    </el-button>
  </div>
  <!-- 发送验证码的对话框 -->
  <div>
    <el-dialog v-model="dialogVisible_1" title="发送手机验证码" width="512px">
      <!-- 输入验证码 -->
      <el-input placeholder="请输入验证码" v-model="code">
        <!-- 验证码图片，点击可刷新 -->
        <template #append>
          <el-image
            @click="update_validate_image"
            class="code-image"
            :src="validate_image_url"
          >
            <template #error>
              <el-text type="info" size="small">点击刷新</el-text>
            </template>
          </el-image>
        </template>
      </el-input>
      <!-- 发送验证码按钮 -->
      <div class="btns">
        <el-button type="primary" @click="handleCoundDown"
          >发送验证码</el-button
        >
      </div>
    </el-dialog>
    <!-- 验证码弹窗 -->
    <el-dialog v-model="dialogVisible" :title="dialogText" width="20%">
      <span
        >欢迎参与AI Will综合素养挑战赛， 您的动态验证为【<b>{{ codePhone }}</b
        >】， 非本人操作请忽略，感谢您为科创事业添砖加瓦！
      </span>
    </el-dialog>
  </div>
</template>

<script  setup>
import { ElMessage } from "element-plus"; // 引入Element Plus的消息提示组件
import { useValidateImage } from "@/hooks/useValidateImage"; //引入自定义的验证码图片钩子
import { sendCode } from "@/api/index"; //引入发送验证码的API函数

// 使用自定义钩子获取验证码图片和刷新方法
const { validate_image_url, update_validate_image } = useValidateImage();
import { nextTick, ref } from "vue"; // 导入Vue的nextTick和响应式引用ref

// 定义props，接收外部传递的手机号码模型值
const props = defineProps({
  modelValue: {
    default: "",
    type: String,
  },
});

// 定义emits，用于触发父组件的更新事件
const emit = defineEmits(["update:modelValue"]);
// 定义手机号码正则表达式
const phoneReg = /^1[3|4|5|6|7|8|9][0-9]{9}$/;
// 输入手机号码时的处理函数
const handleInput = (value) => {
  emit("update:modelValue", value);
  if (!value) {
    disabled.value = true;
    return;
  }
  if (phoneReg.test(value)) {
    disabled.value = false;
  } else {
    disabled.value = true;
  }
};
// 60秒验证码
const btnText = ref("获取验证码");
const countdown = ref(60);
const disabled = ref(true);
const code = ref("");
const dialogVisible_1 = ref(false);
const dialogVisible = ref(false);
const dialogText = ref("手机验证码(测试阶段-流程使用) ");
const codePhone = ref("");
const handleOpenModal = () => {
  if (!props.modelValue) {
    ElMessage.error("请输入手机号码");
    disabled.value = true;
    nextTick(() => {
      update_validate_image();
    });
    return;
  }
  if (phoneReg.test(props.modelValue)) {
    disabled.value = false;
  } else {
    ElMessage.error("手机号码格式错误");
    disabled.value = true;
  }
  dialogVisible_1.value = true;
};

// 倒计时处理函数
const handleCoundDown = async () => {
  const phone = props.modelValue;
  if (disabled.value) {
    return; // 如果按钮已禁用，则不执行任何操作
  }
  if (!code.value) {
    ElMessage.error("请输入验证码！");
    return;
  }

  let res = await handleSendCode(phone);
  if (!res.success) {
    return;
  }
  dialogVisible_1.value = false;
  let timer = setInterval(() => {
    if (countdown.value <= 0) {
      disabled.value = false;
      btnText.value = "获取验证码";
      clearInterval(timer);
      countdown.value = 60;
    } else {
      btnText.value = countdown.value + "s 后重试";
      countdown.value--;
      disabled.value = true;
    }
  }, 1000);
};

// 发送验证码的处理函数
const handleSendCode = async (phone) => {
  let res = await sendCode({ phone, code: code.value });
  if (res.success) {
    dialogVisible.value = true;
    codePhone.value = res.entity;
    ElMessage.success(res.message);
  } else {
    ElMessage.error(res.message);
  }
  return res;
};
</script>

<style lang="scss" scoped>
.form-container {
  display: flex;
  width: 512px;
}
.btns {
  width: 100%;
  padding-top: 32px;
  display: flex;
  justify-content: center;
}
</style>
```

##### 4.图片上传组件

​	配置图片上传组件的目的是实现一个图片上传组件，主要用于用户上传头像或图片到服务器。这个组件使用了Element Plus的`el-upload`组件，并结合了本地存储的授权Token进行身份验证，确保了上传过程的安全性。配置这个组件的原因是为了在Web应用中提供一个简单、直观且易于使用的图片上传功能，增强用户体验。

> 文件路径：/src/components/upload-image/index.vue

代码如下：

```js
<template>
    <!-- 使用el-upload组件实现头像上传功能 -->
  <el-upload
    class="avatar-uploader"
    :action="UploadUrl"
    :headers="{
      Authorization,
    }"
    name="multipartFile"
    :show-file-list="false"
    :on-success="handleAvatarSuccess"
    :before-upload="beforeAvatarUpload"
    accept=".png, .jpg"
  >
    <!-- 如果有预览URL，则显示图片 -->
    <el-image
      v-if="preview_url"
      :src="preview_url"
      class="avatar"
      :class="{ avatar2: mini }"
    >
    </el-image>
	<!-- 否则显示上传图标 -->
    <el-icon
      v-else
      class="avatar-uploader-icon"
      :class="{ 'avatar-uploader-icon2': mini }"
    >
      <Plus />
    </el-icon>
  </el-upload>
</template>

<script  setup>
import { ref, computed } from "vue";
import { Plus } from "@element-plus/icons-vue";
import { ElMessage } from "element-plus";
// 从本地存储获取授权Token
const Authorization = localStorage.getItem("token")
  ? localStorage.getItem("token")
  : "";

// 上传接口的URL
const UploadUrl = "/api/uploadFile";

// 定义props，用于接收父组件传递的值
const props = defineProps({
  modelValue: String,
  size: Number,
  mini: Boolean,
});

// 定义emits，用于触发更新事件
const emit = defineEmits(["update:modelValue"]);
// 图片URL的响应式引用
const imageUrl = ref("");
// 计算属性，用于生成预览URL
const preview_url = computed(() => {
  let url = null;
  if (imageUrl.value && imageUrl.value.indexOf("/res") == 0) {
    url = imageUrl.value;
  }
  if (props.modelValue && props.modelValue.indexOf("/res") == 0) {
    url = import.meta.env.VITE_APP_HOST + props.modelValue;
  }
  return url;
});
// 上传成功后的处理函数
const handleAvatarSuccess = (response, uploadFile) => {
  let res = response;
  if (!res.success) {
    ElMessage.error(res.message);
  } else {
    emit("update:modelValue", res.entity.fileUrl);
  }
};
// 上传前的校验函数
const beforeAvatarUpload = (rawFile) => {
  const type_arr = ["image/jpeg", "image/png"];
  if (!type_arr.includes(rawFile.type)) {
    ElMessage.error("文件格式不正确!");
    return false;
  }
  const size = props.size ?? 5;
  if (rawFile.size / 1024 / 1024 > size) {
    ElMessage.error("上传大小不得超过 " + size + "M");
    return false;
  }
  return true;
};
</script>

<style lang="scss" scoped>
/* 设置上传区域的样式 */
.avatar-uploader .avatar {
  width: 178px;
  height: 178px;
  display: block;
}

/* 迷你模式下的头像样式 */
.avatar-uploader .avatar2 {
  width: 120px;
  height: 120px;
  display: block;
}

/* 设置上传区域的样式，包括边框、圆角、光标、位置、溢出隐藏和过渡效果 */
.avatar-uploader :deep(.el-upload) {
  border: 1px dashed var(--el-border-color);
  border-radius: 6px;
  cursor: pointer;
  position: relative;
  overflow: hidden;
  transition: var(--el-transition-duration-fast);
}

/* 鼠标悬停时的样式，改变边框颜色 */
.avatar-uploader :deep(.el-upload:hover) {
  border-color: var(--el-color-primary);
}

/* 设置上传图标的样式 */
.el-icon.avatar-uploader-icon {
  font-size: 28px;
  color: #8c939d;
  width: 178px;
  height: 178px;
  text-align: center;
}

/* 迷你模式下的上传图标样式 */
.el-icon.avatar-uploader-icon2 {
  font-size: 28px;
  color: #8c939d;
  width: 120px;
  height: 120px;
  text-align: center;
}
</style>
```

#### 步骤六 实现注册模块

##### 1.页面分析

- 使用`<el-form>`组件来构建表单，设置`label-width`和`size`属性来定义表单的布局和大小。
- 使用`<el-form-item>`组件来创建每个表单项，包括学校类型选择、单位名称输入、证件执照上传、负责人姓名输入、手机号码输入、手机验证码输入、登录密码输入、地址输入、联系邮箱输入和注册邀请码输入。
- 对于需要上传图片的表单项，使用`<UploadImage>`组件。
- 使用`<el-button>`组件来创建提交按钮和跳转到登录页面的按钮。
- 使用`<ProvinceSelect>`组件来允许用户选择省、市、县。

##### 2.页面搭建

​	在上文中，我们对注册组件模块界面的搭建进行了详细分析，为页面搭建奠定了基础。现在，我们将依据这些分析，利用Element Plus的`<el-form>`和`<el-form-item>`组件来构建一个结构清晰、响应式的注册表单。每个输入字段都将通过`<el-form-item>`进行封装，以确保表单的一致性和可维护性。对于特殊字段，如证件执照上传，我们将嵌入自定义的`<UploadImage>`组件来处理图片上传功能。表单的提交和登录跳转操作将通过`<el-button>`组件实现，也为用户提供了友好且直观的注册体验。

> 文件路径：/src/auth/reg.vue

代码如下：

```vue
<template>
  <div id="Header">
    <!-- 内容主体 -->
    <div class="content_reg">
      <div class="header">
        <h1>注册学校账号</h1>
      </div>
      <el-form
        label-width="120px"
        size="large"
        ref="reg_data_ref"
        :model="reg_data"
        :rules="reg_data_rules"
      >
        <div class="block-container">
          <h2>学校信息</h2>
          <div class="form-container">
            <el-form-item label="学校类型" prop="institutionType">
              <el-select
                v-model="reg_data.institutionType"
                placeholder="选择类型"
              >
                <el-option
                  v-for="item in type_data"
                  :key="item.value"
                  :value="item.value"
                  :label="item.label"
                ></el-option>
              </el-select>
            </el-form-item>
            <el-form-item label="单位名称" prop="unitName">
              <el-input
                v-model="reg_data.unitName"
                placeholder="请输入单位名称"
              />
            </el-form-item>
            <el-form-item label="证件执照" prop="licenseImg">
              <UploadImage v-model="reg_data.licenseImg" />
              <el-text type="info" size="small" style="line-height: 22px"
                >上传单位相关证件执照（如营业执照、办学许可证）只能上传 JPG/PNG
                文件，且不超过 5 MB</el-text
              >
            </el-form-item>
            <el-form-item label="负责人姓名" prop="userName">
              <el-input
                v-model="reg_data.userName"
                placeholder="请输入负责人姓名"
              />
            </el-form-item>
            <el-form-item
              label="手机号码"
              prop="phone"
              style="display: flex"
              v-if="false"
            >
              <el-input
                @change="changePhone"
                v-model="reg_data.phone"
                placeholder="请输入手机号码"
              />
              <el-button
                plain
                class="ipn_btn"
                @click="handleCoundDown(reg_data.phone)"
                :disabled="disabled"
                >{{ btnText }}
              </el-button>
            </el-form-item>
            <el-form-item label="手机号码" prop="phone">
              <PhoneSendCode v-model="reg_data.phone" />
            </el-form-item>

            <el-form-item label="手机验证码" prop="phoneCode">
              <el-input
                v-model="reg_data.phoneCode"
                placeholder="请输入手机验证码"
              />
            </el-form-item>

            <el-form-item label="登录密码" prop="password">
              <el-input
                v-model="reg_data.password"
                type="password"
                placeholder="请输入登录密码"
              />
            </el-form-item>
            <el-form-item label="地址" prop="address">
              <el-input
                v-model="reg_data.address"
                placeholder="请填写机构邮寄地址"
                class="content_input"
                v-model.trim="inputValueTrim"
              />
            </el-form-item>
            <el-form-item label="联系邮箱" prop="email">
              <el-input v-model="reg_data.email" placeholder="请输入联系邮箱" />
            </el-form-item>
            <el-form-item label="注册邀请码" prop="channel">
              <el-input
                v-model="reg_data.channel"
                placeholder="请输入注册邀请码"
              />
            </el-form-item>
          </div>
        </div>
        <div class="block-container">
          <h2>所选地区</h2>
          <div class="form-container">
            <el-form-item label="所选地区" prop="county">
              <ProvinceSelect
                v-model:economize="reg_data.economize"
                v-model:market="reg_data.market"
                v-model:county="reg_data.county"
                :showCounty="true"
              />
            </el-form-item>

            <el-form-item>
              <el-button
                type="primary"
                :loading="reg_loading"
                @click="handleReg"
                >立即注册</el-button
              >
              <el-button @click="handleJumpLoginPage">前往登录</el-button>
            </el-form-item>
            <!-- <el-form-item>
              <el-button
                type="primary"
                @click="handleTestCode"
              >测试图形验证码</el-button>
            </el-form-item> -->
          </div>
        </div>
      </el-form>
    </div>
    <!-- 验证码弹窗 -->
    <el-dialog
      v-model="dialogVisible"
      :title="dialogText"
      width="20%"
      :before-close="handleClose"
    >
      <span
        >欢迎参与AI Will综合素养挑战赛， 您的动态验证为【<b>{{ codePhone }}</b
        >】， 非本人操作请忽略，感谢您为科创事业添砖加瓦！
      </span>
      <template #footer>
        <span class="dialog-footer">
          <el-button @click="dialogVisible = false">取消</el-button>
          <el-button type="primary" @click="dialogVisible = false">
            确定
          </el-button>
        </span>
      </template>
    </el-dialog>
  </div>
</template>


<script  setup>
import { ref, onMounted } from "vue";
import ProvinceSelect from "@/components/province-select/index.vue"; // 三级下拉栏组件的引入
// 学校类型
const type_data = [
  {
    label: "学校",
    value: "school",
  },
  {
    label: "机构",
    value: "institution",
  },
  {
    label: "团队",
    value: "team",
  },
  {
    label: "其他",
    value: "other",
  },
];
/**
 * 登录数据
 */
const reg_data = ref({
  institutionType: "school", //机构类型包括  学校:school  机构:institution 团队:team  其他:other
  unitName: "", //单位名称
  licenseImg: "", //营业执照
  userName: "", //姓名
  phone: "", //手机号
  password: "", //密码
  channel: "", //激活码  机构只能填组委会
  economize: null, //省id
  market: null, //市id
  county: null, //县id
  email: "", // 联系邮箱
  code: "", //验证码
  phoneCode: "", // 手机验证码
  address: "",
});
</script>


<style lang="scss" scoped>
#Header {
  height: 100vh;
  width: 100%;
  overflow-y: auto;
  //   background: #8473f724;
  background-image: url("@/assets/images/LoginOrRegin/login_bgc.png");
  padding-top: 120px;
  padding-bottom: 32px;
  box-sizing: border-box;

  .content_reg {
    display: flex;
    flex-direction: column;
    width: 740px;
    border-radius: 16px;
    background: #fff;
    margin: 0 auto;
    box-shadow: 0px 2px 4px 0px rgba(0, 0, 0, 0.05);
    padding: 20px;

    .block-container {
      margin-top: 32px;

      .form-container {
        width: 512px;
        padding-top: 16px;
      }
    }
  }
}
:deep(.el-input__wrapper) {
  padding: 0 15px;
}
:deep(.el-input-group__append) {
  padding: 0;
  cursor: pointer;
  box-sizing: border-box;
}

.code-image {
  height: 100% !important;
  cursor: pointer;
  text-align: center;
}
.ipn_btn {
  position: absolute;
  right: 0;
}
:deep .el-space__item {
  flex: 1;
}
</style>
```

效果图预览：

![image-20240308174954192](images/image-20240308174954192.png)

##### 3.页面接口对接

​	在上文中，我们已经完成了注册模块页面的详细分析和搭建工作。接下来的任务是实现页面与后端服务的接口对接，这是确保注册流程能够顺利进行的关键步骤。我们将通过编写相应的HTTP请求代码，将表单数据发送到服务器，并处理服务器返回的响应，以实现用户注册、信息验证和错误提示等功能。

> 文件路径：/src/auth/reg.bue

```vue
<template>
  <div id="Header">
    <!-- 内容主体 -->
      
   <!-- 省略上方代码... -->
  </div>
</template>

<script  setup>
import { useRouter, useRoute } from "vue-router";
import { ref, onMounted } from "vue";
import { ElMessage } from "element-plus";
import { RegApi } from "@/api/user";  // 引入注册接口
import { sendCode } from "@/api/index.js";  // 引入获取验证码接口
import UploadImage from "@/components/upload-image/index.vue";  // 引入图片上传组件
import ProvinceSelect from "@/components/province-select/index.vue";  // 引入三级下拉栏组件
import PhoneSendCode from "@/components/phone-send-code/index.vue";  // 引入手机验证码组件

// 路由
const router = useRouter();
const route = useRoute();
// 学校类型数据
const type_data = [
  {
    label: "学校",
    value: "school",
  },
  {
    label: "机构",
    value: "institution",
  },
  {
    label: "团队",
    value: "team",
  },
  {
    label: "其他",
    value: "other",
  },
];
// 手机号码验证函数
const checkPhone = (rule, value, callback) => {
  const phoneReg = /^1[3|4|5|6|7|8|9][0-9]{9}$/;
  if (!value) {
    callback(new Error("手机号码不能为空"));
  }
  if (phoneReg.test(value)) {
    callback();
  } else {
    callback(new Error("手机号码格式错误"));
  }
};
const reg_data_ref = ref();
// 注册表单的验证规则
const reg_data_rules = ref({
  institutionType: [
    {
      type: "string",
      required: true,
      message: "请选择学校类型",
      trigger: "blur",
    },
  ],
  unitName: [
    {
      type: "string",
      required: true,
      message: "请输入单位名称",
      trigger: "blur",
    },
  ],
  licenseImg: [
    {
      type: "string",
      required: true,
      message: "请上传证件执照",
      trigger: "blur",
    },
  ],
  userName: [
    {
      type: "string",
      required: true,
      message: "请输入负责人姓名",
      trigger: "blur",
    },
  ],

  phone: [
    {
      required: true,
      validator: checkPhone,
    },
  ],
  password: [
    {
      type: "string",
      required: true,
      message: "请输入密码",
      trigger: "blur",
    },
  ],
  channel: [
    {
      type: "string",
      required: true,
      message: "请输入邀请码",
      trigger: "blur",
    },
  ],
  email: [
    {
      type: "string",
      required: true,
      message: "请输入联系邮箱",
      trigger: "blur",
    },
    {
      validator: (rule, value, callback) => {
        // 使用正则表达式验证邮箱格式
        const emailPattern = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/;
        if (emailPattern.test(value)) {
          // 邮箱格式合法，通过校验
          callback();
        } else {
          // 邮箱格式不合法，校验失败，显示提示信息
          callback(new Error("联系邮箱格式不正确"));
        }
      },
      trigger: "blur",
    },
  ],
  county: [
    {
      required: true,
      message: "请选择地区",
      trigger: "blur",
    },
  ],
  phoneCode: [
    {
      type: "string",
      required: true,
      message: "请输入手机验证码",
      trigger: "blur",
    },
  ],
  address: [
    {
      type: "string",
      required: true,
      message: "请输入地址",
      trigger: "blur",
    },
    {
      min: 2,
      max: 120,
      message: "地址请输入 2-120 个字符",
      trigger: "blur",
    },
  ],
});

/**
 * 跳转到注册页
 */
const handleJumpLoginPage = () => {
  router.push("/auth/login");
};
/**
 * 注册数据
 */
const reg_data = ref({
  institutionType: "school", //机构类型包括  学校:school  机构:institution 团队:team  其他:other
  unitName: "", //单位名称
  licenseImg: "", //营业执照
  userName: "", //姓名
  phone: "", //手机号
  password: "", //密码
  channel: "", //激活码  机构只能填组委会
  economize: null, //省id
  market: null, //市id
  county: null, //县id
  email: "", // 联系邮箱
  code: "", //验证码
  phoneCode: "", // 手机验证码
  address: "",
});

/**
 * 注册状态
 */
const reg_loading = ref(false);
 // 注册处理函数
const handleReg = () => {
  reg_data_ref.value.validate(async (v) => {
    if (!v) {
      return;
    }
   
    reg_loading.value = true;
    let res = await RegApi(reg_data.value);
    if (!res.success) {
      ElMessage.error(res.message);
    } else {
      router.push("/auth/login");
      ElMessage.success(res.message);
    }
    reg_loading.value = false;
  });
};

// 对话框可见性
const dialogVisible = ref(false);
const dialogText = ref("手机验证码(测试阶段-流程使用) ");
// 动态验证的手机号码
const codePhone = ref("");
// 发送验证码处理函数
const handleSendCode = async (phone) => {
  let res = await sendCode({ phone });

  if (res.success) {
    dialogVisible.value = true;
    codePhone.value = res.entity;
    ElMessage.success(res.message);
  } else {
    ElMessage.error(res.message);
  }
};

// 60秒验证码倒计时处理函数
const btnText = ref("获取验证码");
const countdown = ref(60);
const disabled = ref(true);
const handleCoundDown = (phone) => {
    // 验证码倒计时逻辑
  if (reg_data.value.code == "") {
    ElMessage.error("请填写验证码");
    return;
  }
  if (disabled.value) {
    return; // 如果按钮已禁用，则不执行任何操作
  }

  handleSendCode(phone);
  let timer = setInterval(() => {
    if (countdown.value <= 0) {
      disabled.value = false;
      btnText.value = "获取验证码";
      clearInterval(timer);
      countdown.value = 60;
    } else {
      btnText.value = countdown.value + "s 后重试";
      countdown.value--;
      disabled.value = true;
    }
  }, 1000);
};

// 必须判断成功后才可以点击获取验证码
const changePhone = () => {
  reg_data_ref.value.validate(async (valid, roles) => {
    if (!roles.phone) {
      disabled.value = false;
    } else {
      disabled.value = true;
    }
  });
};

// /**
//  * 生命周期钩子，组件挂载后执行
//  */
onMounted(() => {
  reg_data.value.channel = route.query.channel ?? "";
});
</script>

<style lang="scss" scoped>
// 省略上方代码
</style>
```

##### 4.注册成功

这里的`注册邀请码`先默认填写：**AIWill_3UL0UTV3**

![image-20240311085742012](images/image-20240311085742012.png)

![image-20240311085837772](images/image-20240311085837772.png)

### 子任务3-2 实现登录模块

#### 步骤一 编写路由配置

​	这里我们主要编写路由配置通过Vue Router，我们设定了登录页面的路径（'/auth/login'），以及管理页面的路径（'/manage'）。核心逻辑是确保用户在成功登录后能够被重定向到管理页面，以便用户可以无缝地进入系统开始管理工作。这样的路由配置直接关联了登录和管理系统，确保了用户访问的连贯性和便捷性。

> 文件路径：/src/router/index.js

代码如下：

```js
import { createRouter, createWebHashHistory, createWebHistory } from "vue-router";
// routes
const routes = [
    {
        redirect: "/home",
        path: "/"
    },
    // 首页
    {
        path: '/home',
        name: "home",
        component: () => import("@/view/home/index.vue")
    },
    // 管理页
    {
        path: '/manage',
        name: "manage",
        component: () => import("@/view/manage/index.vue"),
	},
    // auth
    {
        path: '/auth',
        redirect: "/auth/login",
        component: () => import("@/view/auth/index.vue"),
        children: [
             // 登录
            {
                path: 'login',
                component: () => import("@/view/auth/login.vue")
            },
            // 注册
            {
                path: 'reg',
                component: () => import("@/view/auth/reg.vue")
            },
        ]
    },
]

// router
const router = createRouter({
    history: createWebHashHistory(),
    routes
});

export default router;
```

#### 步骤二 编写接口

##### 1.查看接口

![image-20240315165225051](images/image-20240315165225051.png)

##### 2.编写接口

> 文件路径：/src/api/user.js

代码如下:

```js
import { request } from "@/utils/axios"; // 引入自定义的axios请求封装函数

/**
 * 登录接口
 * 该函数用于处理用户登录的API请求。
 * @param {Object} data - 包含登录所需的用户信息，如用户名和密码。
 * @returns {Promise} - 返回一个Promise对象，用于异步处理登录请求的结果。
 */
export function LoginApi(data) {
    // 使用封装的axios请求函数发起POST请求到用户登录的API端点
    return request({
        url: "/user/login", // 设置请求的URL为用户登录的API路径
        method: "POST", // 设置请求方法为POST
        data: data // 将用户信息作为请求体发送
    });
}
```

> 文件路径：/src/api/common.js

代码如下：

```js
import { request } from "@/utils/axios"


/**
 * 获取基本信息
 */
export function GetInformationApi() {
    return request(
        {
            url: "/information/getInformation",
            method: "GET",
        }
    );
}

/**
 * 验证码
 */
export function GetCodeApi(params) {
    return request(
        {
            url: '/information/getCode',
            method: "GET",
            params
        }
    );
}
```

#### 步骤三 实现组件编写

##### 1.获取用户信息

> 文件路径：/src/store/user.js

代码如下：

```js
import { defineStore } from 'pinia'
import { LoginApi } from '@/api/user'
import { GetInformationApi } from '@/api/common'

// 创建名为 'user' 的 store
export const useUserStore = defineStore('user', {
    state: () => {
        let token = localStorage.getItem("token")
        let info_data = localStorage.getItem("info_data")
        return {
            // 是否登录
            login: token ? true : false,
            // token
            token: token ?? "",
            // 菜单
            menus: [],
            // 基本信息
            info_data: info_data ? JSON.parse(info_data) : null,
            mode: "default",
            id: null
        }
    },
    actions: {
        /**
         * 登录
         * @param {*} data 
         * @param {string} mode - 登录模式，默认为 'default'，也可以是 'tec'
         * @returns {object} - 登录结果
         */
        async handleLogin(data = {}, mode = 'default') {
            let loginRes;
            try {
                if (mode == 'default') {
                    loginRes = await LoginApi(data);
                }
                if (loginRes.success) {
                    this.mode = mode;
                    this.token = loginRes.entity.token;
                    this.login = true;
                    this.id = loginRes.entity.userId;
                    localStorage.setItem('token', this.token)
                    let infoRes = await this.handleGetInformation();
                    if (!infoRes.success) {
                        return {
                            success: false,
                            message: "用户信息获取失败"
                        }
                    }

                }
            } catch (error) {

                return {
                    success: false,
                    message: "登录失败"
                }
            }
            return loginRes;

        },
        /**
        * 获取用户信息
        * @returns {object} - 获取信息结果
        */
        async handleGetInformation() {
            let infoRes = { success: false };
            console.log(this.id);
            if (this.mode == 'default') {
                infoRes = await GetInformationApi();
            }
            if (infoRes.success) {
                this.info_data = infoRes.entity;

                localStorage.setItem('info_data', JSON.stringify(infoRes.entity))
            }
            return infoRes
        },
        /**
         * 退出登录
         */
        handleExit() {
            localStorage.clear();
            this.login = false;
            this.token = "";
            this.menus = [];
            this.info_data = null;
        }
    }
})
```

##### 2.验证码的hooks封装

> 文件路径：/src/hooks/useValidateImage.js

```js
/**
*	子任务3-1已书写，此处省略...
*/
```

#### 步骤四 实现登录模块

##### 1.页面分析

- 使用HTML和CSS创建页面的基本结构。在这个例子中，页面被分为头部（Header）和内容主体（Content）两个主要部分。
- 头部通常包含品牌标识、导航链接等，而内容主体则专注于登录表单。
- 使用Vue.js的模板语法（如`v-model`）来创建双向数据绑定的表单输入字段。
- 在这个例子中，使用了Element UI库来构建表单，包括输入框（`el-input`）、按钮（`el-button`）等。

##### 2.页面搭建

​	在上文中，我们已经对登录模块的界面进行了细致的分析，明确了页面将由头部和内容主体两部分组成，头部展示品牌和导航，而主体部分则集中于登录表单的设计。我们计划利用Vue.js的强大模板语法，特别是`v-model`指令，来实现表单数据的双向绑定，确保用户输入的即时响应。此外，我们将采用Element UI库提供的组件，如`el-input`和`el-button`，来构建一个直观、易于操作的登录体验。

> 文件路径：/src/auth/login.vue

代码如下：

```vue
<template>
  <div id="Header">
    <!-- 头部 -->
    <div class="header_content">
      <div class="container">
        <div class="container_left">
          <div class="left_img"></div>
        </div>
      </div>
    </div>
    <!-- 内容主体 -->
    <div class="content">
      <div class="content_bgc">
        <div class="content_login">
          <!-- 登陆左侧 -->
          <div class="login_left">
            <div class="login_left_bgc">
              <div class="login_welcome">
                <img src="@/assets/images/Home/login_left.png" alt="" />
              </div>
            </div>
          </div>
          <!-- 登陆右侧 -->
          <div class="login_right">
            <div class="login_bg">
              <div class="login_view">
                <div class="login_header">
                  <div class="view_img">
                    <img src="/logo1.png" alt="" />
                  </div>
                  <div class="view_x">|</div>
                  <div class="view_text">登录</div>
                </div>
                <div class="view_input">
                  <el-form
                    ref="login_data_ref"
                    :model="login_data"
                    :rules="login_data_rules"
                  >
                    <el-form-item prop="phone">
                      <div class="input_value">
                        <el-input
                          class="inp"
                          type="text"
                          size="large"
                          placeholder="手机号码"
                          v-model="login_data.phone"
                          @keyup.enter="handleLogin"
                        />
                      </div>
                    </el-form-item>
                    <el-form-item prop="password">
                      <div class="input_value">
                        <el-input
                          class="inp"
                          type="password"
                          placeholder="密码"
                          size="large"
                          v-model="login_data.password"
                          @keyup.enter="handleLogin"
                        />
                      </div>
                    </el-form-item>
                    <el-form-item prop="code">
                      <div class="input_value">
                        <el-input
                          class="inp inp_code"
                          type="text"
                          placeholder="验证码"
                          size="large"
                          v-model="login_data.code"
                          @keyup.enter="handleLogin"
                        >
                          <template #append>
                            <el-image
                              @click="update_validate_image"
                              class="code-image"
                              :src="validate_image_url"
                            >
                              <template #error>
                                <el-text
                                  type="info"
                                  size="small"
                                  @click="update_validate_image"
                                  >点击刷新</el-text
                                >
                              </template></el-image
                            >
                          </template>
                        </el-input>
                      </div>
                    </el-form-item>
                    <div class="button-view">
                      <el-button
                        color="#6550f5"
                        class="login_btn"
                        size="large"
                        :loading="login_loading"
                        @click="handleLogin"
                        >登录</el-button
                      >

                      <el-link
                        class="password_btn"
                        :loading="login_loading"
                        @click="handleForgetPassword"
                        >忘记密码</el-link
                      >
                    </div>
                  </el-form>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>

<script setup>
 import { ref } from "vue";
    /**
 * 登录数据
 */
const login_data = ref({
  phone: "",
  password: "",
  code: "",
});
</script>

<style lang="scss" scoped>
#Header {
  height: 100vh;
  background: #8473f724;

  // 头部主体
  .header_content {
    display: none !important;
    width: 100%;
    height: 100px;
    font-size: 18px;
    display: flex;
    align-items: center;
    flex-direction: column;
    justify-content: center;
    // background: #312366;
    color: #333;
    line-height: 60px;

    .container {
      width: 1200px;
      margin: 0 auto;

      .container_left {
        display: flex;
        justify-content: space-between;
        align-items: center;
        width: 1180px;
        min-height: 1px;
        margin-right: 10px;
        margin-left: 10px;

        .left_img {
          height: 50px;

          img {
            height: 100%;
          }
        }
      }
    }
  }

  // 内容主体
  .content {
    .content_bgc {
      height: 100vh;
      width: 100%;
      background-repeat: no-repeat;
      background-size: 100%;
      background: url("@/assets/images/login_bgc.png");
      // margin-bottom: 350px;

      .content_login {
        display: flex;
        border-radius: 12px;
        background: #fff;
        margin: 0 auto;
        box-shadow: 0px 2px 4px 0px rgba(0, 0, 0, 0.05);
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        // margin-top: 100px;

        // 左侧
        .login_left {
          display: flex;
          align-items: center;
          justify-content: center;

          .login_left_bgc {
            height: 100%;
          }

          .login_welcome {
            display: flex;
            width: 344px;
            height: 100%;
            align-items: center;
            justify-content: center;

            img {
              width: 100%;
              height: 100%;
              border-radius: 12px 0 0 12px;
            }

            .login_btn {
              position: absolute;
              //   bottom: 40px;
              left: 50%;
              transform: translateX(-50%);
              width: 132px;
            }
          }
        }

        // 右侧
        .login_right {
          width: 370px;
          height: 100%;
          display: flex;
          display: flex;
          align-items: center;
          justify-content: center;

          .login_bg {
            border-radius: 5px;
            width: 335px;
            height: 415px;

            .login_view {
              width: 335px;
              height: 290px;
              margin-top: 64px;
              margin-bottom: 24px;
              text-align: center;

              .login_header {
                display: flex;
                align-items: center;
                justify-content: center;
                height: 24px;
                line-height: 24px;

                .view_img {
                  width: 80px;
                  height: 24px;

                  img {
                    width: 100%;
                  }
                }

                .view_x {
                  margin: 0 10px;
                  color: #ccc;
                }

                .view_text {
                  font-size: 22px;
                }
              }

              .view_input {
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                margin-top: 35px;

                .input_value {
                  position: relative;
                  border-radius: 3px;
                  // width: 280px;
                  height: 40px;
                  background-color: #f6f6f6;
                  box-sizing: border-box;

                  &:nth-child(2) {
                    margin: 20px 0;
                  }

                  &:nth-child(3) {
                    display: flex;
                  }

                  .inp {
                    height: 30px;
                    width: 280px;
                    border: 0;
                    background: transparent;
                    height: 40px;
                    font-size: 16px;
                    line-height: 21px;
                    color: #000000;
                  }

                  // .inp_code {
                  //   width: 80px;
                  // }

                  .input_auth_code {
                  }
                }

                .button-view {
                  position: relative;
                  margin-top: 16px;
                  width: 100%;
                  display: flex;
                  align-items: center;

                  > div:nth-child(2) {
                    width: 40%;
                    padding-left: 8px;
                    box-sizing: border-box;
                  }

                  .login_btn {
                    width: 100%;
                    height: 40px;
                    border: 0px solid rgba(40, 40, 40, 0.47);
                    background: #1964d6;
                    font-size: 20px;
                  }

                  .password_btn {
                    position: absolute;
                    right: 0px;
                    bottom: -24px;
                    font-size: 14px;
                    cursor: pointer;
                  }

                  .tec_login_btn {
                    position: absolute;
                    left: 0px;
                    bottom: -24px;
                    font-size: 14px;
                    cursor: pointer;
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}

:deep(.el-input-group__append) {
  padding: 0;
  //   width: 120px;
  cursor: pointer;
  box-sizing: border-box;
}

.code-image {
  height: 100% !important;
  cursor: pointer;
  text-align: center;
}

.el-input {
  --el-input-bg-color: #f5f5f5;
  --el-input-border-color: #f5f5f5;
}
</style>
```

如图所示：

![image-20240306173015753](images/image-20240306173015753.png)

##### 3.管理页的搭建

​	登录成功后，用户将被自动引导至管理页面。在这个页面上，用户可以查看各种管理任务，如查看审核人员信息、机构信息、报名人员信息等。通过精心规划的布局和直观的界面元素，管理页面旨在提升用户的管理效能，同时确保操作的简便性和系统的稳定性。

> 文件路径：/src/view/manage/index.vue

代码如下：

```vue
<template>管理页面</template>

<script  setup>
</script>

<style lang="scss" scoped>
</style>
```

##### 4.页面接口对接

​	这个页面的目的是为了提供一个用户登录的界面，允许用户通过输入手机号码、密码和验证码来进行身份验证并登录系统。这个页面通常用于教师、学生或其他管理人员登录教育平台或管理系统；登录成功后你会是机构负责人 ---  **待审核**，需要联系上级对你 **审核通过**；

> 文件路径：/src/view/auth/login.vue

代码如下：

```vue
<template>

  <!-- 代码同上 -->

</template>
<script setup>
  import { ref } from "vue";
  import { useUserStore } from "@/store/user";
  import { ElMessage } from "element-plus";
  import { useValidateImage } from "@/hooks/useValidateImage";

  // 使用自定义 Hook 获取验证图片相关数据
  const { validate_image_url, update_validate_image } = useValidateImage();
  
  // 使用用户 Store
  const userStore = useUserStore();

  // 创建 ref 来存储登录数据
  const login_data_ref = ref();

  // 自定义手机号验证规则
  const checkPhone = (rule, value, callback) => {
    const phoneReg = /^1[3|4|5|6|7|8|9][0-9]{9}$/;
    if (!value) {
      callback(new Error("手机号码不能为空"));
    }
    if (phoneReg.test(value)) {
      callback();
    } else {
      callback(new Error("手机号码格式错误"));
    }
  };
  
  // 创建 ref 来存储登录表单验证规则
  const login_data_rules = ref({
    phone: [
      {
        required: true,
        validator: checkPhone,
        trigger: "blur",
      },
    ],
    password: [
      {
        type: "string",
        required: true,
        message: "请输入密码",
        trigger: "blur",
      },
    ],
    code: [
      {
        type: "string",
        required: true,
        message: "请输入验证码",
        trigger: "blur",
      },
    ],
  });
  /**
   * 登录数据
   */
  const login_data = ref({
    phone: "",
    password: "",
    code: "",
  });

  /**
   * 登录状态
   */
  const login_loading = ref(false);

  /**
   * 登录处理函数
   */
  const handleLogin = () => {
    login_data_ref.value.validate(async (valid, fields) => {
      if (!valid) {
        return;
      }
      login_loading.value = true;
      let res = await userStore.handleLogin(login_data.value);
      if (!res.success) {
        // 登录失败处理
        ElMessage.error(res.message);
        // 更新验证码图片
        update_validate_image();
      } else {
        // 登录成功处理
        ElMessage.success(res.message);
        // 跳转到管理页面
        router.push({
          name: "manage",
        });
      }
      login_loading.value = false;
    });
  };
</script>

<style lang="scss" scoped>
    
    // 代码同上
    
</style>
```

登陆成功示例：

![image-20240311104045219](images/image-20240311104045219.png)

![image-20240315100221689](images/image-20240315100221689.png)

### 子任务3-3 实现忘记密码模块

#### 步骤一 编写路由配置

> 文件路径：/src/router/index.js

代码如下：

```js
import { createRouter, createWebHashHistory, createWebHistory } from "vue-router";
// routes
const routes = [
    {
        redirect: "/home",
        path: "/"
    },
    // 首页
    {
        path: '/home',
        name: "home",
        component: () => import("@/view/home/index.vue")
    },
    // 管理页
    {
        path: '/manage',
        name: "manage",
        component: () => import("@/view/manage/index.vue"),
	},
    // auth
    {
        path: '/auth',
        redirect: "/auth/login",
        component: () => import("@/view/auth/index.vue"),
        children: [
           
            // 省略上方代码...
            
            // 忘记密码
            {
                path: 'forgetpassword',
                name: 'forgetpassword',
                component: () => import("@/view/auth/forgetpassword.vue")
            },
        ]
    },
]

// router
const router = createRouter({
    history: createWebHashHistory(),
    routes
});

export default router;
```

#### 步骤二 编写接口

##### 1.查看接口：

![image-20240315165552610](images/image-20240315165552610.png)

##### 2.编写接口

> 文件路径：/src/api/index.js

代码如下：

```js
import { request } from "@/utils/axios"

/**
 * 获取验证码
 */
export function sendCode(params) {
    return request(
        {
            url: "/information/sendCode",
            method: "GET",
            params: params,
        }
    );
}

/**
 * 忘记密码
 */

export function forgetPassword(data) {
    return request(
        {
            url: "/user/forgetPassword",
            method: "POST",
            data,
        }
    );
}

```

> 文件路径：/src/api/common.js

代码如下：

```js
import { request } from "@/utils/axios"

/**
 * 验证码
 */
export function GetCodeApi(params) {
    return request(
        {
            url: '/information/getCode',
            method: "GET",
            params
        }
    );
}
```

#### 步骤三 实现组件编写

##### 1.自定义图片验证hooks

> 文件路径：/src/hooks/useValidateImage.js

代码如下：

```js
/**
* 子任务3-1已书写，此处省略...
*/
```

##### 2.手机验证码组件

> 文件路径：/src/components/phone-send-code/index.js

代码如下：

```js
/**
* 子任务3-1已书写，此处省略...
*/
```

#### 步骤三 实现忘记密码模块

##### 1.页面分析

页面的主要功能是允许用户通过输入手机号码来获取验证码，然后使用这个验证码来重置密码。

- 使用`<template>`标签定义页面的HTML结构。
- 页面包含一个表单，用于输入手机号码、验证码、新密码和确认新密码。
- 表单使用Element UI的`<el-form>`组件，以及`<el-form-item>`、`<el-input>`和`<el-button>`等组件来构建。

##### 2.页面接口对接

​	在上文中，我们已经完成了接口的编写和页面的详细分析，确保了后端服务能够支持用户通过输入手机号码接收验证码，并利用该验证码来重置密码的功能。接下来，我们需要将这些后端接口与页面上的表单输入和操作相连接，通过前端代码来调用这些接口，实现数据的发送和接收。通过精确的接口对接，我们可以确保用户在前端页面上的操作能够顺畅地与后端逻辑相匹配，为用户提供一个安全、便捷的密码重置体验。

> 文件路径：/src/view/forgetpassword.vue

代码如下：

```vue
<template>
  <div id="Header">
    <!-- 内容主体 -->
    <div class="content_reg">
      <div class="header">
        <h1>忘记密码</h1>
      </div>
      <el-form
        label-width="120px"
        size="large"
        ref="reg_data_ref"
        :model="reg_data"
        :rules="reg_data_rules"
      >
        <div class="block-container">
          <div class="form-container">
            <el-form-item label="手机号码" prop="phone" v-if="false">
              <el-input
                @change="changePhone"
                v-model="reg_data.phone"
                placeholder="请输入手机号码"
              />
              <el-button
                plain
                class="ipn_btn"
                @click="handleCoundDown(reg_data.phone)"
                :disabled="disabled"
                >{{ btnText }}
              </el-button>
            </el-form-item>
            <el-form-item label="手机号码" prop="phone">
              <PhoneSendCode v-model="reg_data.phone" />
            </el-form-item>

            <el-form-item label="验证码" prop="code" v-if="false">
              <el-input
                @change="changePhone"
                placeholder="请输入验证码"
                v-model="reg_data.code"
              >
                <template #append>
                  <el-image
                    @click="update_validate_image"
                    class="code-image"
                    :src="validate_image_url"
                  >
                    <template #error>
                      <el-text type="info" size="small">点击刷新</el-text>
                    </template>
                  </el-image>
                </template>
              </el-input>
            </el-form-item>

            <el-form-item label="手机验证码" prop="phoneCode">
              <el-input
                v-model="reg_data.phoneCode"
                placeholder="请输入手机验证码"
              />
            </el-form-item>
            <el-form-item label="输入密码" prop="password">
              <el-input
                v-model="reg_data.password"
                show-password
                type="password"
                placeholder="请输入密码"
              />
            </el-form-item>
            <el-form-item label="再次输入密码" prop="passwordToo">
              <el-input
                v-model="reg_data.passwordToo"
                show-password
                type="password"
                placeholder="请再次输入密码"
              />
            </el-form-item>
            <el-form-item>
              <el-button
                type="primary"
                :loading="reg_loading"
                @click="handleJumpLoginPage"
                class="open_serve"
                >提交</el-button
              >
            </el-form-item>
          </div>
        </div>
      </el-form>
    </div>
    <!-- 验证码弹窗 -->
    <el-dialog
      v-model="dialogVisible"
      :title="dialogText"
      width="20%"
      :before-close="handleClose"
    >
      <span
        >欢迎参与AI Will综合素养挑战赛， 您的动态验证为【<b>{{ codePhone }}</b
        >】， 非本人操作请忽略，感谢您为科创事业添砖加瓦！
      </span>
      <template #footer>
        <span class="dialog-footer">
          <el-button @click="dialogVisible = false">取消</el-button>
          <el-button type="primary" @click="dialogVisible = false">
            确定
          </el-button>
        </span>
      </template>
    </el-dialog>
  </div>
</template>

<script  setup>
import { useRouter, useRoute } from "vue-router";
import { ref, onMounted } from "vue";
import { ElMessage } from "element-plus";
import { useValidateImage } from "@/hooks/useValidateImage";
import { sendCode, forgetPassword } from "@/api/index";
const { validate_image_url, update_validate_image } = useValidateImage();
import PhoneSendCode from "@/components/phone-send-code/index.vue";

const router = useRouter();
const route = useRoute();

const checkPhone = (rule, value, callback) => {
  const phoneReg = /^1[3|4|5|6|7|8|9][0-9]{9}$/;
  if (!value) {
    callback(new Error("手机号码不能为空"));
  }
  if (phoneReg.test(value)) {
    callback();
  } else {
    callback(new Error("手机号码格式错误"));
  }
};

const checkPass = (rule, value, callback) => {
  if (value === "") {
    callback(new Error("请输入密码"));
  } else {
    callback();
  }
};
const checkPass2 = (rule, value, callback) => {
  if (value === "") {
    callback(new Error("请再次输入密码"));
  } else if (value !== reg_data.value.password) {
    callback(new Error("两次输入密码不一致!"));
  } else {
    callback();
  }
};

const reg_data_ref = ref();
const reg_data_rules = ref({
  phone: [
    {
      required: true,
      validator: checkPhone,
    },
  ],
  password: [
    {
      type: "string",
      required: true,
      validator: checkPass,
      trigger: "blur",
    },
  ],
  passwordToo: [
    {
      type: "string",
      required: true,
      validator: checkPass2,
      trigger: "blur",
    },
  ],
  phoneCode: [
    {
      type: "string",
      required: true,
      message: "请输入手机验证码",
      trigger: "blur",
    },
  ],
});
/**
 * 跳转到登录页
 */
const handleJumpLoginPage = async () => {
  reg_data_ref.value.validate(async (v) => {
    if (!v) {
      return;
    }
    let res = await forgetPassword(reg_data.value);

    if (res.success) {
      ElMessage.success(res.message);
      router.push("/auth/login");
    } else {
      ElMessage.error(res.message);
      update_validate_image();
    }
  });
};

// 获取验证码
const dialogVisible = ref(false);
const dialogText = ref("手机验证码(测试阶段-流程使用) ");
const codePhone = ref("");
const handleSendCode = async (phone) => {
  let res = await sendCode({ phone });

  if (res.success) {
    dialogVisible.value = true;
    codePhone.value = res.entity;
    ElMessage.success(res.message);
  } else {
    ElMessage.error(res.message);
  }
};

// 60秒验证码
const btnText = ref("获取验证码");
const countdown = ref(60);
const disabled = ref(true);
const handleCoundDown = (phone) => {
  if (reg_data.value.code == "") {
    ElMessage.error("请填写验证码");
    return;
  }
  if (disabled.value) {
    return; // 如果按钮已禁用，则不执行任何操作
  }

  handleSendCode(phone);
  let timer = setInterval(() => {
    if (countdown.value <= 0) {
      disabled.value = false;
      btnText.value = "获取验证码";
      clearInterval(timer);
      countdown.value = 60;
    } else {
      btnText.value = countdown.value + "s 后重试";
      countdown.value--;
      disabled.value = true;
    }
  }, 1000);
};

/**
 * 登录数据
 */
const reg_data = ref({
  phone: "", //手机号
  password: "", //密码
  passwordToo: "", // 再次输入密码
  code: "", // 验证码
  phoneCode: "", // 手机验证码
});

// 必须判断成功后才可以点击获取验证码
const changePhone = () => {
  reg_data_ref.value.validate(async (valid, roles) => {
    if (!roles.phone) {
      disabled.value = false;
    } else {
      disabled.value = true;
    }
  });
};
/**
 * onMounted
 */
onMounted(() => {
  reg_data.value.channel = route.query.channel ?? "";
});
</script>

<style lang="scss" scoped>
#Header {
  height: 100vh;
  width: 100%;
  overflow-y: auto;
  //   background: #8473f724;
  background-image: url("@/assets/images/LoginOrRegin/login_bgc.png");
  padding-top: 180px;
  padding-bottom: 32px;
  box-sizing: border-box;

  .content_reg {
    display: flex;
    flex-direction: column;
    width: 740px;
    border-radius: 16px;
    background: #fff;
    margin: 0 auto;
    box-shadow: 0px 2px 4px 0px rgba(0, 0, 0, 0.05);
    padding: 20px;

    .block-container {
      margin-top: 32px;

      .form-container {
        width: 512px;
        padding-top: 16px;
      }
    }
  }
}

:deep(.el-input-group__append) {
  padding: 0;
  cursor: pointer;
  box-sizing: border-box;
}

.code-image {
  height: 40px !important;
  cursor: pointer;
  text-align: center;
}

.inp_ip {
  width: 270px;
}

.ipn_btn {
  position: absolute;
  right: 0;
}

// 忘记密码提交按钮
.open_serve {
  width: 120px;
}
</style>
```

![image-20240315160018050](images/image-20240315160018050.png)

##### 3.修改成功

![image-20240311105225913](images/image-20240311105225913.png)
